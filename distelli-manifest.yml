bmcgehee/PHPNGINXUbuntu:

  Env:
    - MYSQL_ROOT: "pa55w0rd"
    - DB_USER: "doc@localhost"
    - DB_USER_PWD: "pa55w0rd"
    - DB_NAME: "example"

  PreInstall:
    - echo "===Starting PreInstall==="

    - echo "---Install for Mysql---"
    - sudo debconf-set-selections <<< "mysql-server mysql-server/root_password password $MYSQL_ROOT"
    - sudo debconf-set-selections <<< "mysql-server mysql-server/root_password_again password $MYSQL_ROOT"
    - sudo apt-get -y update
    - sudo apt-get -y install mysql-server
    - sudo apt-get -y install php5-mysql
    - mysql -u root -p$MYSQL_ROOT -e 'CREATE DATABASE IF NOT EXISTS "$DB_NAME"; GRANT ALL PRIVILEGES ON "$DB_NAME".* TO “$DB_USER” IDENTIFIED BY "$DB_USER_PWD"'

    - echo "---Install for php---"
    - sudo apt-get -y install php5-fpm

    - echo "---Install for NGINX---"
    - sudo apt-get -y install nginx
    - sudo service nginx start

    - echo "---Updating php.ini---"
    - sudo echo "cgi.fix_pathinfo=0" >> /etc/php5/fpm/php.ini

    - echo "---Updating nginx/sites-available/default---"
    - sudo echo "location ~\.php$ {" >> /etc/nginx/sites-available/default
    - sudo echo "  fastcgi_split_path_info ^(.+\.php)(/.+)$;" >> /etc/nginx/sites-available/default
    - sueo echo "  fastcgi_pass unix:/var/run/php5-fpm.sock;" >> /etc/nginx/sites-available/default
    - sudo echo "  fastcgi_index index.php;" >> /etc/nginx/sites-available/default
    - sudo echo "  include fastcgi_params;" >> /etc/nginx/sites-available/default
    - sudo echo "}" >> /etc/nginx/sites-available/default

    - echo "=====Done with PreInstall======"

  PostInstall:
    - echo "===Begin PostInstall==="

    - echo "---restarting php---"
    - sudo service php-fpm restart

    - echo "---restarting nginx---"
    - sudo service nginx restart

    - echo "=====Done with PostInstall======"


  Install:
    - echo "===Begin Install==="
    - sudo ln -sf $DISTELLI_INSTALLHOME /usr/share/nginx/html
    - echo "=====Done with Install======"